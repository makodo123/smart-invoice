# Smart Invoice 智能發票對獎 - 優化摘要

## 🚀 核心優化

本次優化將原本單純的「發票對獎」工具，升級為具備「智能記帳」功能的強大助手。

### 1. 🧠 AI 智能識別升級
- **模型升級**: 切換至 `gemini-2.0-flash` 模型。
- **結構化數據**: 不再只識別發票號碼，現在能精準提取：
  - 📅 **消費日期** (YYYY/MM/DD)
  - 🏪 **商家名稱**
  - 💰 **消費金額**
- **JSON Schema**: 強制 AI 輸出標準 JSON 格式，提高識別穩定性。

### 2. ⚡ 性能與流量優化
- **客戶端壓縮**: 引入 `compressImage` 工具。
- **機制**: 上傳圖片前自動壓縮至 1024px 寬度，品質 0.8。
- **效益**: 
  - 上傳速度提升 3-5 倍
  - 大幅節省 API Token 使用量
  - 減少網路延遲

### 3. 📊 數據管理與導出
- **本地記帳**: 識別後的發票詳細資訊會自動保存在本地 (LocalStorage)。
- **Excel 導出**: 新增「匯出 Excel」按鈕，一鍵生成 CSV 報表。
- **應用場景**: 方便用戶月底進行記帳整理或報銷。

### 4. 🛠️ 工程與部署修復
- **部署修復**: 修正 `vite.config.ts` 中的 `base` 路徑，解決 GitHub Pages 白屏問題。
- **類型定義**: 完善 TypeScript 類型系統，增加 `InvoiceData` 定義。

## 📦 檔案變更清單

- `vite.config.ts`: 添加 base 路徑
- `types.ts`: 新增 InvoiceData 接口
- `services/gemini.ts`: 重寫識別邏輯，支持結構化輸出
- `utils/imageUtils.ts`: (新增) 圖片壓縮工具
- `utils/export.ts`: (新增) CSV 導出工具
- `utils/storage.ts`: 增加發票數據存儲邏輯
- `components/CheckSection.tsx`: 整合所有新功能，更新 UI 顯示

## 📝 測試指南

1. **上傳測試**:
   - 上傳一張清晰的電子發票圖片。
   - 確認是否能識別出：號碼、日期、金額、商家。
   - 確認是否自動進行了對獎。

2. **導出測試**:
   - 掃描幾張發票後。
   - 點擊「匯出 Excel」按鈕。
   - 檢查下載的 CSV 檔案內容是否正確 (亂碼檢查)。

3. **部署測試**:
   - 推送代碼後，檢查 GitHub Pages 是否能正常加載 (無白屏)。
